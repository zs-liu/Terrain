环境
====

-   macOS Catalina 10.15.1

-   C++ 11

-   OpenGL 4.1

-   CLion 2019.2.4

操作说明
========

FPS风格的摄像机，方向键为WASD，鼠标可控制相机方向。摄像机移动位置受到一定限制。

R可以切换岩石纹理，G可以切换草地纹理。

细节和思路
==========

架构
----

- 所有外部资源（包括纹理、高度图和glsl）均通过静态类ResourceManager统一载入和销毁。

- manager文件夹中存放了静态类ResourceManager、着色器类shader以及纹理类texture。

- painters文件夹中存放了天空盒、小岛和海浪的渲染类。

- static\_source文件夹中存放了纹理和glsl代码。

天空盒
------

-   天空盒高度height和宽度width均在Island.h中设定

-   使用GL\_TRIANGLE\_FAN从而免于使用EBO

小岛
----

-   整个小岛高度height和宽度width均在SkyBox.h中设定

-   以灰度模式读入HeightMap，对数值进行缩放后作为各点高度

-   小岛各点的$z$坐标有一定负偏移使得中心小湖处于水平面下

-   渲染倒影时，片段着色器中抛弃所有$z>0$的片段

-   小岛以EBO索引渲染并且开启了面剔除。小岛渲染时剔除背面，倒影渲染时剔除正面

-   片段着色器中根据纹理的G通道所占比重判断进一步添加岩石纹理还是草地纹理

海浪
----

-   通过若干个不同幅度、波数、频率的二维正弦波组成，正弦波振幅在中心处衰减$$\begin{split}
                    {x}(t)&={x}_0-\sum_i\frac{{k}_i}{|{k}_i|}\cdot{}A_i\sin({k}_i\cdot{x}_0-\omega_i t)\\
                    h(t)&=h_0+\sum_iA_i\cos({k}_i\cdot{x}_0-\omega_i t)
                \end{split}$$

-   使用法线贴图展示纹理效果，光照为平行光，移动方向为波数的加权和

-   从中心向四周逐渐透明，透明度同时受到相机角度的影响

-   绘制海浪时，获取相机位置，以此为中心由近及远绘制三角面片，使得多个三角面片的颜色不会相互叠加

其他
====

遵循协议GPL v3.0。
